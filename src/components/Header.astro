---
import Feather from "./Feather.astro";
const {title} = Astro.props
---

<style>
    mdui-navigation-drawer::part(panel) {
        background: rgb(var(--mdui-color-secondary-container));
    }

    .profile-infobox{
        background-color: rgba(var(--mdui-color-primary), 0.2);
        background-image: url("/profile_background.jpg");
        background-size: cover;
    }
    .profile-avatar{
        border: solid 2px #617cfb;
    }
    #main-drawer {
        box-shadow: var(--mdui-elevation-level2);
    }

    .app-bar{
        background: rgb(var(--mdui-color-primary-container));
    }
</style>
{/** 抽屉栏 */}
<mdui-navigation-drawer class="not-open-if-mobile"
                        open id="main-drawer" close-on-esc close-on-overlay-click

>
    <div class="profile-infobox w-full aspect-video">
        <div class="w-full aspect-video bg-[#0000007f] relative flex flex-col mdui-theme-dark">
            <div class="">
                <!--top-->
            </div>
            <div class="grow">
                <!--mid-->
            </div>
            <div class="p-4">
                <mdui-top-app-bar-title>
                <img class="profile-avatar w-[3em] m-4 rounded-full inline-block" src="/avatar.png" /> Name
                </mdui-top-app-bar-title>
            </div>

        </div>
    </div>
    <mdui-list>
        <mdui-list-item>Navigation drawer</mdui-list-item>
    </mdui-list>
</mdui-navigation-drawer>

{/** 顶栏 */}
<mdui-top-app-bar variant="medium"
                  scroll-behavior="shrink elevate"
                  scroll-target=".main-article-wrapper"
                  class="p-3 position-relative app-bar"
>
    <mdui-button-icon id="btn-open-drawer" style="color: rgba(var(--mdui-color-primary), 1)">
        <Feather icon="menu"></Feather>
    </mdui-button-icon>
    <mdui-top-app-bar-title>
        {title}
        <span slot="label-large">{title}</span>
    </mdui-top-app-bar-title>
    <div style="flex-grow: 1"></div>
    <mdui-button-icon id="btn-toggle-theme" style="color: rgba(var(--mdui-color-primary), 1)">
        <Feather icon="moon" class="icon-toggle-theme-dark"></Feather>
        <Feather icon="sun" class="icon-toggle-theme-light"></Feather>
    </mdui-button-icon>
    <mdui-button-icon id="btn-more" style="color: rgba(var(--mdui-color-primary), 1)">
        <Feather icon="more-vertical"></Feather>
    </mdui-button-icon>

    <script>
        import type {NavigationDrawer, Button} from 'mdui';
        import {setTheme, getTheme, setColorScheme} from 'mdui';

        const drawer = document.getElementById('main-drawer') as NavigationDrawer;

        drawer.addEventListener('open', (event) => {
            console.log('drawer opening ')
        })


        const timer = setInterval(() => {
            if (drawer.hasAttribute('mobile')) {
                drawer.open = false;
                clearInterval(timer);

                drawer.addEventListener('closed', (event) => {
                    drawer.classList.remove('not-open-if-mobile');
                    console.debug('抽屉栏关闭');
                }, {once: true});
            }
        }, 100)

        const btn = document.getElementById('btn-open-drawer') as HTMLElement;
        btn.addEventListener("click", () => drawer.open = !drawer.open);

        const btn2 = document.getElementById('btn-toggle-theme') as HTMLElement;
        btn2.addEventListener("click", () => {
            if (getTheme() === 'dark') {
                setTheme('light');
                // setColorScheme('#ffb6c1')
                // setColorScheme('#9824e5');
            }else {
                setTheme('dark');
                // setColorScheme('#ff9fcf')
                // setColorScheme('#9824e5');
            }
        });



    </script>


</mdui-top-app-bar>
